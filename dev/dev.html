<!DOCTYPE html>
<html lang="en" class="fuelux">
<head>
	<meta charset="utf-8">
	<title>dev.html</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link href="../bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet" type="text/css">

	<!--<link href="../dist/css/fuelux.css" rel="stylesheet" type="text/css">-->

	<!--CLIENT-SIDE LESS COMPILATION FOR WATCHER-LESS DEV-->
	<link href="../less/fuelux.less" rel="stylesheet/less" type="text/css"/>
	<script src="//cdnjs.cloudflare.com/ajax/libs/less.js/1.7.0/less.min.js"></script>
	<script type="text/javascript">if(window.console && window.console.clear){ window.console.clear(); }</script>

	<script src="../bower_components/requirejs/require.js" type="text/javascript"></script>
	<script type="text/javascript">
		(function () {
			requirejs.config({
				config: {
					moment: {
						noGlobal: true
					}
				},
				paths: {
					jquery: '../bower_components/jquery/dist/jquery',
					underscore: '../bower_components/underscore/underscore',
					bootstrap: '../bower_components/bootstrap/dist/js/bootstrap',
					//moment: '../bower_components/moment/min/moment-with-langs',
					fuelux: '../js'
				},
				shim: {
					'bootstrap': {
						deps: ['jquery'],
						exports: 'bootstrap'
					}
				}
			});
		})();
		require(['jquery', '../data', 'fuelux/all'], function($, data){
			// simulate network latency
			var loadDelays = ['300', '600', '900', '1200'];

			// list view setup
			var list = function(options, callback){

				// build dataSource based with options
				var resp = {
					count: data.repeater.listData.length,
					items: [],
					page: options.pageIndex
				};

				// get start and end limits for JSON
				var i, l;
				resp.pages = Math.ceil(resp.count/(options.pageSize || 50));

				i = options.pageIndex * (options.pageSize || 50);
				l = i + (options.pageSize || 50);
				l = (l <= resp.count) ? l : resp.count;
				resp.start = i + 1;
				resp.end = l;

				// setup columns for list view
				resp.columns = [
					{
						label: 'Common Name',
						property: 'commonName',
						sortable: true
					},
					{
						label: 'Latin Name',
						property: 'latinName',
						sortable: true
					},
					{
						label: 'Appearance',
						property: 'appearance',
						sortable: true
					},
					{
						label: 'Sound',
						property: 'sound',
						sortable: true
					}
				];

				// add sample items to datasource
				for(i; i<l; i++){
					// from data.js
					resp.items.push(data.repeater.listData[i]);
				}

				//if(options.search){
				//resp.items = [];
				//}

				// call and simulate latency
				setTimeout(function(){
					callback(resp);
				}, loadDelays[Math.floor(Math.random() * 4)]);
			};


			// thumbnail view setup
			var thumbnail = function(options, callback){
				var sampleImageCategories = ['abstract', 'animals', 'business', 'cats', 'city', 'food', 'nature', 'technics', 'transport'];
				var numItems = 200;

				// build dataSource based with options
				var resp = {
					count: numItems,
					items: [],
					pages: (Math.ceil(numItems/(options.pageSize || 30))),
					page: options.pageIndex
				};

				// get start and end limits for JSON
				var i, l;
				i = options.pageIndex * (options.pageSize || 30);
				l = i + (options.pageSize || 30);
				resp.start = i + 1;
				resp.end = l;

				// add sample items to datasource
				for(i; i<l; i++){
					resp.items.push({
						name: ('Thumbnail ' + (i + 1)),
						src: 'http://lorempixel.com/65/65/' + sampleImageCategories[Math.floor(Math.random() * 9)] + '/?_=' + i
					});
				}

				//if(options.search){
				//resp.items = [];
				//}

				// call and simulate latency
				setTimeout(function(){
					callback(resp);
				}, loadDelays[Math.floor(Math.random() * 4)]);
			};

			// initialize repater
			$('#myRepeater').repeater({
				dataSource: function(options, callback){
					//you can check view name here, and call separate functions...
					if(options.view==='list.view1'){
						list(options, callback);
					}
				},
				list_selectable: 'multi',
				list_noItemsHTML: 'no items found',
				thumbnail_noItemsHTML: 'no items found',
				thumbnail_infiniteScroll: { hybrid: true },
				views: {
					//you can go with just the view name
					'view1': {
						list_selectable: true
					},
					//this syntax is also supported (makes it possible to do 'list' and 'thumbnail' this way)
					'list.view2': {
						//...or you can do this! :)
						dataSource: function(options, callback){
							list(options, callback);
						},
						list_infiniteScroll: true,
						list_highlightSortedColumn: true
					},
					'thumbnail.view3': {
						thumbnail_alignment: 'center',
						dataSource: function(options, callback){
							thumbnail(options, callback);
						},
						thumbnail_selectable: 'multi'
					}
				}
			});

//			setTimeout(function(){
//				$('#myRepeater').repeater('render', {
//					dataSourceOptions: {
//						pageIndex: 1,
//						pageSize: 20,
//						filter: { text: 'Some', value: 'some' }
//						//sortProperty: 'name',
//						//sortDirection: 'asc',
//						//search: 'term'
//					},
//					preserveDataSourceOptions: true
//				});
//			}, 5000);
		});
	</script>
</head>

<body style="padding: 20px;">
	<div class="container" style="padding: 20px; margin-top:20px;">

		<div class="fuelux">
			<ul class="tree" role="tree" id="test-tree">
				<li class="tree-branch hide" data-template="treebranch" role="treeitem" aria-expanded="false">
					<div class="tree-branch-header">
						<button class="tree-branch-name"> <span class="glyphicon icon-caret glyphicon-play"></span>
							<span class="glyphicon icon-folder glyphicon-folder-close"></span>
							<span class="tree-label"></span>

						</button>
					</div>
					<ul class="tree-branch-children" role="group"></ul>
					<div class="tree-loader hide" role="alert">Loading...</div>
				</li>
				<li class="tree-item hide" data-template="treeitem" role="treeitem">
					<button class="tree-item-name"> <span class="glyphicon icon-item fueluxicon-bullet"></span>
						<span class="tree-label"></span>

					</button>
				</li>
			</ul>
		</div>

	</div>
</body>
</html>
